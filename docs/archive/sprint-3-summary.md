# Sprint 3 - AI é›†æˆä¸ä¼˜åŒ–å¼€å‘æ€»ç»“

**å¼€å‘æ—¶é—´**: 2025-12-02
**çŠ¶æ€**: ğŸŸ¡ éƒ¨åˆ†å®Œæˆ (AI åŠŸèƒ½å·²å®ç°,API è¿æ¥å¾…è§£å†³)

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ç¯å¢ƒé…ç½® (.env)
- âœ… åˆ›å»º `.env` æ–‡ä»¶å­˜å‚¨ API å¯†é’¥
- âœ… é…ç½® `CLAUDE_API_KEY`
- âœ… é…ç½® `CLAUDE_API_BASE_URL` (https://relay.nf.video)
- âœ… å·²åœ¨ `.gitignore` ä¸­æ’é™¤,ç¡®ä¿å®‰å…¨

**æ–‡ä»¶**: `.env`

### 2. æµ‹è¯•ç»“æœæ”¶é›†å™¨
- âœ… å®ç° `TestResultCollector` ç±»
- âœ… æ”¯æŒæ”¶é›†æµ‹è¯•ç»“æœ (passed/failed/skipped)
- âœ… ç”Ÿæˆæµ‹è¯•æ‘˜è¦ç»Ÿè®¡
- âœ… æŒ‰å•†å“åˆ†ç»„å¤±è´¥æµ‹è¯•
- âœ… æ”¯æŒ pytest æ’ä»¶é›†æˆ
- âœ… å¯¼å‡º JSON æ ¼å¼æŠ¥å‘Š

**æ–‡ä»¶**: `core/test_result_collector.py` (336 è¡Œ)

**æ ¸å¿ƒåŠŸèƒ½**:
```python
collector = TestResultCollector("reports/test-results.json")
collector.start_session()

# æ·»åŠ æµ‹è¯•ç»“æœ
collector.add_test_result(
    test_id="test_example",
    test_name="test_cart",
    status="failed",
    duration=2.5,
    product_id="fiido-t1",
    error_message="Cart empty",
    screenshot_path="screenshots/failure.png"
)

# ä¿å­˜ç»“æœ
report = collector.save()
```

### 3. AI æŠ¥å‘Šç”Ÿæˆå™¨
- âœ… å®ç° `AIReportGenerator` ç±»
- âœ… é›†æˆ Claude API (anthropic SDK)
- âœ… æ”¯æŒè‡ªå®šä¹‰ API æœåŠ¡å™¨ (base_url)
- âœ… ç”Ÿæˆä¸“ä¸š Markdown æµ‹è¯•æŠ¥å‘Š
- âœ… å¤±è´¥åˆ†æå’Œè¶‹åŠ¿æ´å¯Ÿ
- âœ… è¡ŒåŠ¨å»ºè®®ç”Ÿæˆ

**æ–‡ä»¶**: `scripts/generate_ai_report.py` (350+ è¡Œ)

**åŠŸèƒ½ç‰¹æ€§**:
- ğŸ“Š æµ‹è¯•æ‘˜è¦åˆ†æ
- ğŸ” å¤±è´¥åŸå› è¯†åˆ«
- ğŸ“ˆ è¶‹åŠ¿æ´å¯Ÿ
- ğŸ’¡ æ™ºèƒ½ä¿®å¤å»ºè®®
- ğŸ“ Markdown æ ¼å¼è¾“å‡º

**ä½¿ç”¨æ–¹æ³•**:
```bash
# ç”Ÿæˆå®Œæ•´æŠ¥å‘Š
python scripts/generate_ai_report.py

# ä»…ç”Ÿæˆæ‘˜è¦
python scripts/generate_ai_report.py --summary-only

# è‡ªå®šä¹‰è¾“å‡ºè·¯å¾„
python scripts/generate_ai_report.py --output reports/my-report.md
```

### 4. æµ‹è¯•æ•°æ®å’Œå·¥å…·
- âœ… åˆ›å»ºæ¨¡æ‹Ÿæµ‹è¯•ç»“æœ JSON
- âœ… åˆ›å»º API è¿æ¥æµ‹è¯•è„šæœ¬
- âœ… å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£

---

## âš ï¸ å½“å‰é—®é¢˜

### API è¿æ¥ 403 é”™è¯¯

**é—®é¢˜æè¿°**:
ä½¿ç”¨æä¾›çš„ API å¯†é’¥å’ŒæœåŠ¡å™¨åœ°å€æ—¶,æ‰€æœ‰è¯·æ±‚å‡è¿”å› 403 é”™è¯¯:

```
Error code: 403 - {'error': {'code': '403',
'message': 'Request blocked by content filter.
Your request does not meet the required criteria.',
'type': 'permission_error'}}
```

**æµ‹è¯•è¿‡çš„è¯·æ±‚**:
1. âœ… ç®€å•çš„ "Hello" æ¶ˆæ¯ - **403 é”™è¯¯**
2. âœ… ä¸­æ–‡æç¤ºè¯ - **403 é”™è¯¯**
3. âœ… æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ - **403 é”™è¯¯**

**é…ç½®ä¿¡æ¯**:
- API Key: `sk-ant-sid01--9759d96f7fd9b83e0203130f248dc43ae5872f27f819472f7452d9aa88b3ca6c`
- Base URL: `https://relay.nf.video`
- Model: `claude-sonnet-4-5-20250929`

**å¯èƒ½çš„åŸå› **:
1. API å¯†é’¥æƒé™é™åˆ¶
2. æœåŠ¡å™¨ç«¯å†…å®¹è¿‡æ»¤å™¨é…ç½®è¿‡ä¸¥
3. API å¯†é’¥å¯èƒ½å·²å¤±æ•ˆæˆ–æœªæ¿€æ´»
4. Base URL å¯èƒ½éœ€è¦é¢å¤–çš„è®¤è¯å¤´æˆ–å‚æ•°

---

## ğŸ”§ è§£å†³æ–¹æ¡ˆå»ºè®®

### æ–¹æ¡ˆ1: éªŒè¯ API å¯†é’¥ (æ¨è)
è¯·æ£€æŸ¥:
- API å¯†é’¥æ˜¯å¦æ­£ç¡®å®Œæ•´
- API å¯†é’¥æ˜¯å¦å·²æ¿€æ´»
- æ˜¯å¦æœ‰ä½¿ç”¨é™åˆ¶æˆ–é…é¢

### æ–¹æ¡ˆ2: æ£€æŸ¥æœåŠ¡å™¨é…ç½®
è”ç³» `https://relay.nf.video` æœåŠ¡æä¾›å•†:
- ç¡®è®¤ API å¯†é’¥æ ¼å¼æ˜¯å¦æ­£ç¡®
- æ˜¯å¦éœ€è¦é¢å¤–çš„è¯·æ±‚å¤´
- å†…å®¹è¿‡æ»¤å™¨æ˜¯å¦éœ€è¦è°ƒæ•´

### æ–¹æ¡ˆ3: ä½¿ç”¨å®˜æ–¹ Anthropic API
å¦‚æœæœ‰å®˜æ–¹ API å¯†é’¥,å¯ä»¥ç›´æ¥ä½¿ç”¨:
```bash
# .env æ–‡ä»¶
CLAUDE_API_KEY=your-official-key
# CLAUDE_API_BASE_URL=  # æ³¨é‡Šæ‰æˆ–ç•™ç©ºä½¿ç”¨å®˜æ–¹æœåŠ¡å™¨
```

### æ–¹æ¡ˆ4: ä¸´æ—¶è·³è¿‡ AI åŠŸèƒ½
åœ¨æ²¡æœ‰å¯ç”¨ API çš„æƒ…å†µä¸‹,æ¡†æ¶çš„å…¶ä»–åŠŸèƒ½ä»ç„¶å®Œå…¨å¯ç”¨:
- âœ… å•†å“çˆ¬è™«
- âœ… è‡ªåŠ¨åŒ–æµ‹è¯•
- âœ… æµ‹è¯•ç»“æœæ”¶é›†
- âœ… JSON æ ¼å¼æŠ¥å‘Š

ä»…AI æŠ¥å‘Šç”ŸæˆåŠŸèƒ½æš‚æ—¶ä¸å¯ç”¨ã€‚

---

## ğŸ“‚ åˆ›å»ºçš„æ–‡ä»¶

```
.env                                  # ç¯å¢ƒé…ç½®
core/test_result_collector.py        # æµ‹è¯•ç»“æœæ”¶é›†å™¨
scripts/generate_ai_report.py        # AI æŠ¥å‘Šç”Ÿæˆå™¨
scripts/test_api_connection.py       # API è¿æ¥æµ‹è¯•
reports/test-results.json             # æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®
```

---

## ğŸ“ ä»£ç ç¤ºä¾‹

### æµ‹è¯• API è¿æ¥
```bash
./run.sh python scripts/test_api_connection.py
```

### ç”Ÿæˆ AI æŠ¥å‘Š
```bash
# ç¡®ä¿æœ‰æµ‹è¯•ç»“æœæ–‡ä»¶
./run.sh python scripts/generate_ai_report.py --summary-only
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### å¦‚æœ API å¯ç”¨:
1. ä¿®å¤ API è¿æ¥é—®é¢˜
2. è¿è¡Œå®Œæ•´æµ‹è¯•å¹¶ç”Ÿæˆ AI æŠ¥å‘Š
3. é›†æˆåˆ° CI/CD æµç¨‹
4. æ·»åŠ è‡ªåŠ¨åŒ–å‘Šè­¦

### å¦‚æœ API æš‚æ—¶ä¸å¯ç”¨:
1. ç»§ç»­å®Œå–„å…¶ä»–åŠŸèƒ½ (Web ç•Œé¢ã€ç›‘æ§ç­‰)
2. ä½¿ç”¨ JSON æŠ¥å‘Šä½œä¸ºæ›¿ä»£
3. åç»­é›†æˆ AI åŠŸèƒ½

---

## ğŸ“Š Sprint 3 æˆæœ

| æŒ‡æ ‡ | å®Œæˆåº¦ |
|------|-------|
| æµ‹è¯•ç»“æœæ”¶é›†å™¨ | âœ… 100% |
| AI æŠ¥å‘Šç”Ÿæˆä»£ç  | âœ… 100% |
| API é›†æˆä»£ç  | âœ… 100% |
| é…ç½®å’Œæ–‡æ¡£ | âœ… 100% |
| **API è¿æ¥æµ‹è¯•** | âŒ 0% (403 é”™è¯¯) |
| **æ•´ä½“å®Œæˆåº¦** | ğŸŸ¡ 80% |

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- **ç¯å¢ƒé…ç½®**: `.env`
- **æµ‹è¯•ç»“æœæ ¼å¼**: `reports/test-results.json`
- **API æ–‡æ¡£**: https://docs.anthropic.com/claude/reference

---

**æ€»ç»“**: Sprint 3 çš„æ‰€æœ‰ä»£ç åŠŸèƒ½å·²å®Œæ•´å®ç°,ä»… API è¿æ¥å­˜åœ¨æƒé™é—®é¢˜ã€‚ä¸€æ—¦ API å¯†é’¥é—®é¢˜è§£å†³,AI æŠ¥å‘ŠåŠŸèƒ½å³å¯ç«‹å³ä½¿ç”¨ã€‚æ¡†æ¶çš„æ ¸å¿ƒæµ‹è¯•åŠŸèƒ½ä¸å—å½±å“ã€‚
